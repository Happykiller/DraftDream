
> api@0.10.0 test
> jest

PASS src/graphql/sport/exercise/__tests__/exercise.mapper.spec.ts (9.229 s)
PASS src/graphql/sport/category/__tests__/category.mapper.spec.ts (9.241 s)
PASS src/usecases/sport/session/__tests__/list.sessions.usecase.spec.ts (10.18 s)
PASS src/graphql/nutri/meal/__tests__/meal.mapper.spec.ts (10.119 s)
PASS src/graphql/sport/muscle/__tests__/muscle.mapper.spec.ts (10.1 s)
PASS src/graphql/nutri/meal-day/__tests__/meal-day.mapper.spec.ts
PASS src/graphql/sport/program/__tests__/program.mapper.spec.ts (10.249 s)
PASS src/graphql/nutri/meal-plan/__tests__/meal-plan.mapper.spec.ts (10.338 s)
FAIL src/usecases/sport/exercise/__tests__/get.exercise.usecase.spec.ts (10.605 s)
  â— GetExerciseUsecase â€º should throw a forbidden error when the user is not allowed to access the exercise

    expect(jest.fn()).not.toHaveBeenCalled()

    Expected number of calls: 0
    Received number of calls: 1

    1: "GetExerciseUsecase#execute => GET_EXERCISE_FORBIDDEN"

    [0m [90m 191 |[39m
     [90m 192 |[39m     [36mawait[39m expect(usecase[33m.[39mexecute(dto))[33m.[39mrejects[33m.[39mtoThrow([33mERRORS[39m[33m.[39m[33mGET_EXERCISE_FORBIDDEN[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 193 |[39m     expect(loggerMock[33m.[39merror)[33m.[39mnot[33m.[39mtoHaveBeenCalled()[33m;[39m
     [90m     |[39m                                  [31m[1m^[22m[39m
     [90m 194 |[39m   })[33m;[39m
     [90m 195 |[39m
     [90m 196 |[39m   it([32m'should log and throw a domain error when retrieval fails'[39m[33m,[39m [36masync[39m () [33m=>[39m {[0m

      at Object.<anonymous> (src/usecases/sport/exercise/__tests__/get.exercise.usecase.spec.ts:193:34)

PASS src/usecases/prospect/level/__tests__/get.prospect-level.usecase.spec.ts (10.823 s)
PASS src/graphql/tag/__tests__/tag.mapper.spec.ts
FAIL src/usecases/nutri/meal-day/__tests__/get.meal-day.usecase.spec.ts (11.054 s)
  â— GetMealDayUsecase â€º should reject when the session is not allowed to access the meal day

    expect(jest.fn()).not.toHaveBeenCalled()

    Expected number of calls: 0
    Received number of calls: 1

    1: "GetMealDayUsecase#execute => GET_MEAL_DAY_FORBIDDEN"

    [0m [90m 108 |[39m
     [90m 109 |[39m     [36mawait[39m expect(usecase[33m.[39mexecute(dto))[33m.[39mrejects[33m.[39mtoThrow([33mERRORS[39m[33m.[39m[33mGET_MEAL_DAY_FORBIDDEN[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 110 |[39m     expect(loggerMock[33m.[39merror)[33m.[39mnot[33m.[39mtoHaveBeenCalled()[33m;[39m
     [90m     |[39m                                  [31m[1m^[22m[39m
     [90m 111 |[39m   })[33m;[39m
     [90m 112 |[39m
     [90m 113 |[39m   it([32m'should log and throw a domain error when retrieval fails'[39m[33m,[39m [36masync[39m () [33m=>[39m {[0m

      at Object.<anonymous> (src/usecases/nutri/meal-day/__tests__/get.meal-day.usecase.spec.ts:110:34)

PASS src/usecases/nutri/meal/__tests__/get.meal.usecase.spec.ts (10.992 s)
PASS src/usecases/prospect/level/__tests__/delete.prospect-level.usecase.spec.ts (11.595 s)
PASS src/usecases/sport/exercise/__tests__/create.exercise.usecase.spec.ts (11.492 s)
PASS src/usecases/nutri/meal/__tests__/list.meal.usecase.spec.ts (11.49 s)
PASS src/usecases/nutri/meal/__tests__/create.meal.usecase.spec.ts (11.605 s)
PASS src/usecases/sport/exercise/__tests__/list.exercises.usecase.spec.ts
PASS src/usecases/nutri/meal/__tests__/update.meal.usecase.spec.ts (11.898 s)
PASS src/usecases/prospect/source/__tests__/delete.prospect-source.usecase.spec.ts (11.94 s)
PASS src/usecases/auth/__tests__/auth.usecase.spec.ts
FAIL src/usecases/sport/program/__tests__/list.programs.usecase.spec.ts (11.924 s)
  â— ListProgramsUsecase â€º should list programs for coaches within accessible creators

    expect(received).toEqual(expected) // deep equality

    - Expected  - 0
    + Received  + 1

    @@ -2,9 +2,10 @@
        Object {
          "createdByIn": ArrayContaining [
            "coach-1",
            "admin-1",
          ],
    +     "includePublicVisibility": true,
          "limit": 10,
          "page": 1,
        },
      ]

    [0m [90m 142 |[39m       }[33m,[39m
     [90m 143 |[39m     ])[33m;[39m
    [31m[1m>[22m[39m[90m 144 |[39m     expect(asMock(programRepositoryMock[33m.[39mlist)[33m.[39mmock[33m.[39mcalls[[35m0[39m])[33m.[39mtoEqual([
     [90m     |[39m                                                              [31m[1m^[22m[39m
     [90m 145 |[39m       {
     [90m 146 |[39m         page[33m:[39m [35m1[39m[33m,[39m
     [90m 147 |[39m         limit[33m:[39m [35m10[39m[33m,[39m[0m

      at Object.<anonymous> (src/usecases/sport/program/__tests__/list.programs.usecase.spec.ts:144:62)

PASS src/usecases/nutri/meal-type/__tests__/delete.meal-type.usecase.spec.ts (11.914 s)
PASS src/usecases/prospect/level/__tests__/create.prospect-level.usecase.spec.ts (11.965 s)
PASS src/graphql/sport/equipment/__tests__/equipment.mapper.spec.ts
PASS src/usecases/sport/session/__tests__/update.session.usecase.spec.ts
PASS src/usecases/nutri/meal/__tests__/delete.meal.usecase.spec.ts (12.231 s)
PASS src/usecases/prospect/level/__tests__/update.prospect-level.usecase.spec.ts
PASS src/usecases/prospect/objective/__tests__/update.prospect-objective.usecase.spec.ts (12.441 s)
PASS src/usecases/nutri/meal-plan/__tests__/list.meal-plans.usecase.spec.ts
PASS src/usecases/sport/category/__tests__/delete.category.usecase.spec.ts
PASS src/usecases/sport/session/__tests__/delete.session.usecase.spec.ts
PASS src/usecases/prospect/source/__tests__/list.prospect-source.usecase.spec.ts (12.732 s)
PASS src/usecases/sport/category/__tests__/get.category.usecase.spec.ts
PASS src/usecases/prospect/activity-preference/__tests__/delete.prospect-activity-preference.usecase.spec.ts
PASS src/usecases/prospect/activity-preference/__tests__/create.prospect-activity-preference.usecase.spec.ts
PASS src/usecases/sport/program/__tests__/update.program.usecase.spec.ts
PASS src/usecases/athlete/coach-athlete/__tests__/create.coach-athlete.usecase.spec.ts
PASS src/usecases/nutri/meal-type/__tests__/list.meal-type.usecase.spec.ts
PASS src/usecases/sport/program/__tests__/delete.program.usecase.spec.ts
PASS src/usecases/nutri/meal-plan/__tests__/update.meal-plan.usecase.spec.ts
PASS src/usecases/nutri/meal-plan/__tests__/create.meal-plan.usecase.spec.ts
PASS src/usecases/prospect/source/__tests__/update.prospect-source.usecase.spec.ts
PASS src/usecases/prospect/objective/__tests__/list.prospect-objective.usecase.spec.ts
PASS src/usecases/sport/equipment/__tests__/delete.equipment.usecase.spec.ts
PASS src/usecases/nutri/meal-type/__tests__/get.meal-type.usecase.spec.ts
PASS src/usecases/prospect/activity-preference/__tests__/list.prospect-activity-preference.usecase.spec.ts
PASS src/usecases/prospect/objective/__tests__/create.prospect-objective.usecase.spec.ts
PASS src/usecases/sport/muscle/__tests__/delete.muscle.usecase.spec.ts
PASS src/usecases/athlete/coach-athlete/__tests__/list.coach-athletes.usecase.spec.ts
PASS src/usecases/sport/category/__tests__/list.category.usecase.spec.ts
PASS src/usecases/athlete/coach-athlete/__tests__/delete.coach-athlete.usecase.spec.ts
PASS src/usecases/nutri/meal-plan/__tests__/delete.meal-plan.usecase.spec.ts
PASS src/usecases/sport/session/__tests__/get.session.usecase.spec.ts
PASS src/usecases/prospect/activity-preference/__tests__/update.prospect-activity-preference.usecase.spec.ts
PASS src/usecases/nutri/meal-day/__tests__/create.meal-day.usecase.spec.ts
PASS src/usecases/sport/exercise/__tests__/delete.exercise.usecase.spec.ts
PASS src/usecases/tag/__tests__/delete.tag.usecase.spec.ts
PASS src/usecases/default/__tests__/db.test.usecase.spec.ts
PASS src/graphql/nutri/meal-type/__tests__/meal-type.mapper.spec.ts
PASS src/usecases/user/__tests__/get.user.usecase.spec.ts
PASS src/usecases/tag/__tests__/create.tag.usecase.spec.ts
PASS src/usecases/sport/muscle/__tests__/update.muscle.usecase.spec.ts
PASS src/usecases/user/__tests__/create.user.usecase.spec.ts
PASS src/usecases/sport/equipment/__tests__/list.equipment.usecase.spec.ts
PASS src/usecases/sport/muscle/__tests__/create.muscle.usecase.spec.ts
PASS src/usecases/sport/muscle/__tests__/list.muscles.usecase.spec.ts
PASS src/usecases/sport/program/__tests__/get.program.usecase.spec.ts
PASS src/usecases/nutri/meal-type/__tests__/update.meal-type.usecase.spec.ts
PASS src/usecases/sport/program/__tests__/create.program.usecase.spec.ts
PASS src/usecases/tag/__tests__/list.tags.usecase.spec.ts
PASS src/usecases/tag/__tests__/get.tag.usecase.spec.ts
PASS src/usecases/nutri/meal-day/__tests__/update.meal-day.usecase.spec.ts
PASS src/usecases/nutri/meal-plan/__tests__/get.meal-plan.usecase.spec.ts
PASS src/usecases/user/__tests__/update.user.usecase.spec.ts
PASS src/usecases/prospect/level/__tests__/list.prospect-level.usecase.spec.ts
PASS src/usecases/prospect/objective/__tests__/delete.prospect-objective.usecase.spec.ts
PASS src/usecases/sport/category/__tests__/update.category.usecase.spec.ts
PASS src/usecases/sport/program/__tests__/program.mapper.spec.ts
PASS src/common/__tests__/slug.util.spec.ts
PASS src/graphql/user/__tests__/user.mapper.spec.ts
PASS src/usecases/nutri/meal-day/__tests__/delete.meal-day.usecase.spec.ts
PASS src/graphql/sport/session/__tests__/session.mapper.spec.ts
PASS src/usecases/sport/category/__tests__/create.category.usecase.spec.ts
PASS src/usecases/nutri/meal-plan/__tests__/meal-plan.mapper.spec.ts
PASS src/usecases/sport/exercise/__tests__/exercise.mapper.spec.ts
PASS src/usecases/sport/equipment/__tests__/create.equipment.usecase.spec.ts
PASS src/usecases/sport/muscle/__tests__/get.muscle.usecase.spec.ts
PASS src/common/__tests__/error.util.spec.ts
PASS src/usecases/prospect/source/__tests__/create.prospect-source.usecase.spec.ts
PASS src/usecases/nutri/meal-day/__tests__/meal-day.mapper.spec.ts
PASS src/usecases/sport/session/__tests__/session.mapper.spec.ts
PASS src/usecases/sport/equipment/__tests__/get.equipment.usecase.spec.ts
PASS src/usecases/sport/session/__tests__/create.session.usecase.spec.ts
PASS src/usecases/prospect/source/__tests__/get.prospect-source.usecase.spec.ts
PASS src/usecases/prospect/activity-preference/__tests__/get.prospect-activity-preference.usecase.spec.ts
PASS src/usecases/sport/exercise/__tests__/update.exercise.usecase.spec.ts
PASS src/usecases/nutri/meal-day/__tests__/list.meal-day.usecase.spec.ts (5.082 s)
PASS src/usecases/prospect/objective/__tests__/get.prospect-objective.usecase.spec.ts
PASS src/usecases/athlete/coach-athlete/__tests__/get.coach-athlete.usecase.spec.ts
PASS src/usecases/user/__tests__/list.users.usecase.spec.ts
PASS src/usecases/nutri/meal-type/__tests__/create.meal-type.usecase.spec.ts
PASS src/usecases/tag/__tests__/update.tag.usecase.spec.ts
PASS src/usecases/athlete/coach-athlete/__tests__/update.coach-athlete.usecase.spec.ts
PASS src/usecases/sport/equipment/__tests__/update.equipment.usecase.spec.ts

Summary of all failing tests
FAIL src/usecases/sport/exercise/__tests__/get.exercise.usecase.spec.ts (10.605 s)
  â— GetExerciseUsecase â€º should throw a forbidden error when the user is not allowed to access the exercise

    expect(jest.fn()).not.toHaveBeenCalled()

    Expected number of calls: 0
    Received number of calls: 1

    1: "GetExerciseUsecase#execute => GET_EXERCISE_FORBIDDEN"

    [0m [90m 191 |[39m
     [90m 192 |[39m     [36mawait[39m expect(usecase[33m.[39mexecute(dto))[33m.[39mrejects[33m.[39mtoThrow([33mERRORS[39m[33m.[39m[33mGET_EXERCISE_FORBIDDEN[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 193 |[39m     expect(loggerMock[33m.[39merror)[33m.[39mnot[33m.[39mtoHaveBeenCalled()[33m;[39m
     [90m     |[39m                                  [31m[1m^[22m[39m
     [90m 194 |[39m   })[33m;[39m
     [90m 195 |[39m
     [90m 196 |[39m   it([32m'should log and throw a domain error when retrieval fails'[39m[33m,[39m [36masync[39m () [33m=>[39m {[0m

      at Object.<anonymous> (src/usecases/sport/exercise/__tests__/get.exercise.usecase.spec.ts:193:34)

FAIL src/usecases/nutri/meal-day/__tests__/get.meal-day.usecase.spec.ts (11.054 s)
  â— GetMealDayUsecase â€º should reject when the session is not allowed to access the meal day

    expect(jest.fn()).not.toHaveBeenCalled()

    Expected number of calls: 0
    Received number of calls: 1

    1: "GetMealDayUsecase#execute => GET_MEAL_DAY_FORBIDDEN"

    [0m [90m 108 |[39m
     [90m 109 |[39m     [36mawait[39m expect(usecase[33m.[39mexecute(dto))[33m.[39mrejects[33m.[39mtoThrow([33mERRORS[39m[33m.[39m[33mGET_MEAL_DAY_FORBIDDEN[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 110 |[39m     expect(loggerMock[33m.[39merror)[33m.[39mnot[33m.[39mtoHaveBeenCalled()[33m;[39m
     [90m     |[39m                                  [31m[1m^[22m[39m
     [90m 111 |[39m   })[33m;[39m
     [90m 112 |[39m
     [90m 113 |[39m   it([32m'should log and throw a domain error when retrieval fails'[39m[33m,[39m [36masync[39m () [33m=>[39m {[0m

      at Object.<anonymous> (src/usecases/nutri/meal-day/__tests__/get.meal-day.usecase.spec.ts:110:34)

FAIL src/usecases/sport/program/__tests__/list.programs.usecase.spec.ts (11.924 s)
  â— ListProgramsUsecase â€º should list programs for coaches within accessible creators

    expect(received).toEqual(expected) // deep equality

    - Expected  - 0
    + Received  + 1

    @@ -2,9 +2,10 @@
        Object {
          "createdByIn": ArrayContaining [
            "coach-1",
            "admin-1",
          ],
    +     "includePublicVisibility": true,
          "limit": 10,
          "page": 1,
        },
      ]

    [0m [90m 142 |[39m       }[33m,[39m
     [90m 143 |[39m     ])[33m;[39m
    [31m[1m>[22m[39m[90m 144 |[39m     expect(asMock(programRepositoryMock[33m.[39mlist)[33m.[39mmock[33m.[39mcalls[[35m0[39m])[33m.[39mtoEqual([
     [90m     |[39m                                                              [31m[1m^[22m[39m
     [90m 145 |[39m       {
     [90m 146 |[39m         page[33m:[39m [35m1[39m[33m,[39m
     [90m 147 |[39m         limit[33m:[39m [35m10[39m[33m,[39m[0m

      at Object.<anonymous> (src/usecases/sport/program/__tests__/list.programs.usecase.spec.ts:144:62)


Test Suites: 3 failed, 102 passed, 105 total
Tests:       3 failed, 428 passed, 431 total
Snapshots:   0 total
Time:        17.596 s
Ran all test suites.
